# Thread vs Process

### 멀티태스킹

컴퓨터가 프로세스 여러개를 함께 구동하는 것

멀티태스킹이 없다면 게임을 설치할 때 컴퓨터는 멈출 것이다.

### 프로그램(Program)

`.exe`파일처럼 컴퓨터에서 실행할 수 있는 파일을 `프로그램`이라고 함  


### 프로세스(Process)

- 실행된 프로그램을 의미
- OS로부터 **시스템 자원**(Code, Data, Stack, Heap ...)을 할당받는 작업의 단위
- 메모리에 올라가 실행되고 있는 프로그램의 인스턴스
- 하나의 프로세스는 최소 1개의 스레드(메인 스레드)를 갖고 있음
- 각각의 프로세스는 서로의 정보를 공유할 수 없음
- 단, IPC(inter-process communication)으로 프로세스간 통신이 가능
  - 파이프, 소켓 등을 이용한 통신 방법  
    

### 멀티 프로세스

- 동시적, 병렬적, 혼합 방법
- **동시성**(Concurrency)
  - `Context switching`으로 진행
- **병렬성**(Parallelism)
  - 한 CPU에 코어가 여러개(멀티 코어)
- **Context Switching  오버헤드**
  - 프로세스는 각각의 독립된 메모리 영역을 할당 받았기에 프로세스 사이에 공유하는 메모리가 없어, **Context Switching이 발생하면 캐쉬에 있는 모든 데이터를 리셋**하고 다시 캐쉬 정보를 불러와야 한다.  
    

### 스레드(Thread)

프로세스 내에서 실행되는 여러 흐름의 단위

- 프로세스 내에서 Stack만 각각 할당 받고, <u>Code, Data, Heap 영역은 공유</u>한다
- 각각의 스레드는 별도의 레지스터와 스택을 갖고 있지만, 힙 메모리는 서로 읽고 쓸 수 있다.



- 그럼 구글크롬의 각 탭은 **스레드**일까 **프로세스**일까?
- 크롬은 왜이리 **메모리를 많이 차지**할까?  

  

### 멀티 프로세스 vs 멀티 스레드

#### 멀티 프로세스

- 하나의 프로그램을 여러 개의 프로세스로 구성하는 것
- 여러 개의 자식 프로세스 중 하나에 문제가 발생하면 그 자식 프로세스만 죽음
- Context Switching에서의 오버헤드가 있음
- 프로세스 사이의 통신을 위해 IPC 기법을 사용함

#### 멀티 스레드

- 하나의 프로그램을 여러 개의 스레드로 구성
- 윈도우, 리눅스 등 많은 OS들이 멀티 프로세싱을 지원하고 있지만 멀티 스레딩을 기본으로 사욯암
- **웹 서버는 대표적인 멀티 스레드 응용 프로그램**
- 프로세스를 생성하여 자원 할당하는 `시스템 콜`이 줄어 자원을 효율적으로 관리
- 스레드 사이의 작업량이 작아 Context Switching이 빠름
- Stack 영역을 제외한 모든 메모리를 공유하므로 통신 부담이 적음
- 디버깅이 까다로움
- 단일 프로세스 시스템은 효과를 기대하기 어려움
- 동기화 문제가 발생함
  - 공유된 자원 공유 문제
- 하나의 스레드에 문제가 발생하면 전체 프로세스가 영향 받음



### Java의 스레드

- JVM이 OS의 역할을 한다
- 일반 스레드와 차이가 거의 없다
- **프로세스가 없고 스레드만 존재한다**
- 스레드의 갯수, 상태, 메모리 위치, 우선순위 **모두 JVM이 관리**



### Java에서 Thread 중복 방지

`synchronized(){ }`를 통해 해당 함수 내에선 하나의 스레드만 접근할 수 있게 할 수 있다.

---

### 참고자료

- https://www.youtube.com/watch?v=iks_Xb9DtTM
- https://gmlwjd9405.github.io/2018/09/14/process-vs-thread.html
- 